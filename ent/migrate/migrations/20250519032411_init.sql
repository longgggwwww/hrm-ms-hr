-- Create "departments" table
CREATE TABLE "public"."departments" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY, "name" character varying NOT NULL, "code" character varying NOT NULL, "org_id" bigint NOT NULL, "created_at" timestamptz NOT NULL, "updated_at" timestamptz NOT NULL, PRIMARY KEY ("id"));
-- Create index "department_org_id_code" to table: "departments"
CREATE UNIQUE INDEX "department_org_id_code" ON "public"."departments" ("org_id", "code");
-- Create "organizations" table
CREATE TABLE "public"."organizations" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY, "name" character varying NOT NULL, "code" character varying NOT NULL, "logo_url" character varying NULL, "address" character varying NULL, "phone" character varying NULL, "email" character varying NULL, "website" character varying NULL, "created_at" timestamptz NOT NULL, "updated_at" timestamptz NOT NULL, "parent_id" bigint NULL, PRIMARY KEY ("id"), CONSTRAINT "organizations_organizations_children" FOREIGN KEY ("parent_id") REFERENCES "public"."organizations" ("id") ON UPDATE NO ACTION ON DELETE SET NULL);
-- Create index "organizations_code_key" to table: "organizations"
CREATE UNIQUE INDEX "organizations_code_key" ON "public"."organizations" ("code");
-- Create "positions" table
CREATE TABLE "public"."positions" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY, "name" character varying NOT NULL, "code" character varying NOT NULL, "created_at" timestamptz NOT NULL, "updated_at" timestamptz NOT NULL, "department_id" bigint NOT NULL, "parent_id" bigint NULL, PRIMARY KEY ("id"), CONSTRAINT "positions_departments_positions" FOREIGN KEY ("department_id") REFERENCES "public"."departments" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION, CONSTRAINT "positions_positions_children" FOREIGN KEY ("parent_id") REFERENCES "public"."positions" ("id") ON UPDATE NO ACTION ON DELETE SET NULL);
-- Create index "position_department_id_code" to table: "positions"
CREATE UNIQUE INDEX "position_department_id_code" ON "public"."positions" ("department_id", "code");
-- Create "employees" table
CREATE TABLE "public"."employees" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY, "user_id" character varying NOT NULL, "code" character varying NOT NULL, "status" character varying NOT NULL DEFAULT 'active', "joining_at" timestamptz NOT NULL, "org_id" bigint NOT NULL, "created_at" timestamptz NOT NULL, "updated_at" timestamptz NOT NULL, "position_id" bigint NOT NULL, PRIMARY KEY ("id"), CONSTRAINT "employees_positions_employees" FOREIGN KEY ("position_id") REFERENCES "public"."positions" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION);
-- Create index "employees_code_key" to table: "employees"
CREATE UNIQUE INDEX "employees_code_key" ON "public"."employees" ("code");
-- Create index "employees_user_id_key" to table: "employees"
CREATE UNIQUE INDEX "employees_user_id_key" ON "public"."employees" ("user_id");
-- Create "leave_approvals" table
CREATE TABLE "public"."leave_approvals" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY, "comment" character varying NULL, "created_at" timestamptz NOT NULL, "updated_at" timestamptz NOT NULL, PRIMARY KEY ("id"));
-- Create "leave_requests" table
CREATE TABLE "public"."leave_requests" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY, "total_days" double precision NOT NULL, "start_at" timestamptz NOT NULL, "end_at" timestamptz NOT NULL, "reason" character varying NULL, "type" character varying NOT NULL DEFAULT 'annual', "status" character varying NOT NULL DEFAULT 'pending', "created_at" timestamptz NOT NULL, "updated_at" timestamptz NOT NULL, "leave_request_leaveapprove" bigint NULL, PRIMARY KEY ("id"), CONSTRAINT "leave_requests_leave_approvals_leaveapprove" FOREIGN KEY ("leave_request_leaveapprove") REFERENCES "public"."leave_approvals" ("id") ON UPDATE NO ACTION ON DELETE SET NULL);
-- Create "projects" table
CREATE TABLE "public"."projects" ("id" uuid NOT NULL, "name" character varying NOT NULL, "description" character varying NULL, "start_at" timestamptz NOT NULL, "end_at" timestamptz NULL, "creator_id" uuid NOT NULL, "updater_id" uuid NOT NULL, "created_at" timestamptz NOT NULL, "updated_at" timestamptz NOT NULL, "branch_id" uuid NOT NULL, "process" bigint NOT NULL, "status" character varying NOT NULL DEFAULT 'not_started', PRIMARY KEY ("id"));
-- Create "tasks" table
CREATE TABLE "public"."tasks" ("id" uuid NOT NULL, "title" character varying NOT NULL, "description" character varying NULL, "process" bigint NOT NULL, "status" boolean NOT NULL, "start_at" timestamptz NOT NULL, "branch_id" uuid NOT NULL, "creator_id" uuid NOT NULL, "updater_id" uuid NOT NULL, "created_at" timestamptz NOT NULL, "updated_at" timestamptz NOT NULL, "project_id" uuid NOT NULL, PRIMARY KEY ("id"), CONSTRAINT "tasks_projects_tasks" FOREIGN KEY ("project_id") REFERENCES "public"."projects" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION);
